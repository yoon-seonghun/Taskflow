import{d as L,r as u,z as G,c as Y,o as U,f as c,g as t,p,t as n,k as w,F as D,s as $,m as E,T as q,q as N,x as W,j as _,i as S,l as z,L as P,n as l}from"./index-D8qsMxsh.js";import{h as J}from"./history-B3yM7zqs.js";import{i as K}from"./item-CAonLf5Y.js";import{u as Q}from"./useToast-BaLNVjwd.js";import{u as X}from"./useConfirm-tRg9u8MQ.js";import"./MarkdownEditor.vue_vue_type_style_index_0_scoped_f90f4426_lang-Bc65I5vA.js";import{_ as Z}from"./Spinner.vue_vue_type_script_setup_true_lang-i4Z96JvV.js";import{_ as tt}from"./Badge.vue_vue_type_script_setup_true_lang-BICiYF9q.js";import{_ as et}from"./EmptyState.vue_vue_type_script_setup_true_lang-DF03tBGG.js";import{_ as st}from"./Pagination.vue_vue_type_script_setup_true_lang-D8QDOFFt.js";const at={class:"h-full flex flex-col"},ot={class:"flex items-center justify-between mb-4"},rt={class:"text-sm text-gray-500 mt-1"},nt={class:"flex items-center gap-2 text-sm text-gray-600"},lt={class:"bg-white rounded-lg border border-gray-200 p-4 mb-4"},it={class:"flex flex-wrap items-center gap-4"},ct={class:"flex items-center gap-2"},dt={class:"flex rounded-lg border border-gray-200 overflow-hidden"},ut=["onClick"],pt={key:0,class:"flex items-center gap-2"},xt={class:"ml-auto flex items-center gap-2"},mt=["title"],gt={class:"flex-1 bg-white rounded-lg border border-gray-200 overflow-hidden flex flex-col"},ft={key:0,class:"flex-1 flex items-center justify-center"},ht={class:"flex-1 overflow-auto"},vt={class:"w-full"},yt={class:"divide-y divide-gray-100"},wt={class:"px-4 h-10 text-[13px] text-gray-600 whitespace-nowrap"},_t={class:"px-4 h-10 text-[13px] text-red-600 font-medium whitespace-nowrap"},kt={class:"px-4 h-10 text-[13px] text-gray-900"},bt={class:"flex items-center gap-2"},Dt=["title"],St={key:0,class:"px-1.5 py-0.5 text-[11px] bg-gray-100 text-gray-500 rounded flex-shrink-0"},Mt={class:"px-4 h-10"},Ct={class:"px-4 h-10 text-[13px] text-gray-600 whitespace-nowrap"},Tt={class:"flex items-center gap-2"},$t={class:"w-6 h-6 rounded-full bg-red-100 text-red-600 flex items-center justify-center text-[11px] font-medium"},Et={class:"px-4 h-10 text-center"},Nt=["onClick"],zt={key:0,class:"border-t border-gray-200 px-4 py-3 flex items-center justify-between"},Pt={class:"text-sm text-gray-500"},Yt=L({__name:"DeletedTasksView",setup(Vt){const g=Q(),V=X(),k=u(!1),b=u([]),r=u({page:0,size:20,totalElements:0,totalPages:0}),x=u("today"),f=u(""),h=u(""),m=u("desc"),j=[{value:"today",label:"오늘"},{value:"week",label:"이번주"},{value:"month",label:"이번달"},{value:"custom",label:"사용자 지정"}];function M(a){const e=new Date,s=v(e);switch(a){case"today":return{startDate:s,endDate:s};case"week":{const o=new Date(e),i=e.getDay(),d=i===0?6:i-1;return o.setDate(e.getDate()-d),{startDate:v(o),endDate:s}}case"month":{const o=new Date(e.getFullYear(),e.getMonth(),1);return{startDate:v(o),endDate:s}}case"custom":return{startDate:f.value||s,endDate:h.value||s};default:return{startDate:s,endDate:s}}}function v(a){const e=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0");return`${e}-${s}-${o}`}function C(a){if(!a)return"-";const e=new Date(a),s=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),d=String(e.getHours()).padStart(2,"0"),O=String(e.getMinutes()).padStart(2,"0");return`${s}-${o}-${i} ${d}:${O}`}function T(a){return a?{NOT_STARTED:"시작전",IN_PROGRESS:"진행중",PENDING:"보류"}[a]||a:"-"}function B(a){return a&&{NOT_STARTED:"default",IN_PROGRESS:"primary",PENDING:"warning"}[a]||"default"}async function y(a=0){k.value=!0;try{const{startDate:e,endDate:s}=M(x.value),o={result:"DELETED",startDate:e,endDate:s,page:a,size:r.value.size,sort:`deletedAt,${m.value}`},i=await J.getItemHistory(o);if(i.success&&i.data){const d=i.data;b.value=d.content,r.value={page:d.page,size:d.size,totalElements:d.totalElements,totalPages:d.totalPages}}else g.error(i.message||"삭제된 작업을 불러오는데 실패했습니다.")}catch{g.error("삭제된 작업을 불러오는데 실패했습니다.")}finally{k.value=!1}}async function A(a){if(await V.show({title:"업무 복원",message:`이 업무를 복원하시겠습니까?
복원 후 상태: ${T(a.previousStatus)}`,confirmText:"복원",confirmType:"primary"}))try{const s=await K.restoreItem(a.boardId,a.itemId);s.success?(g.success("업무가 복원되었습니다."),y(r.value.page)):g.error(s.message||"복원에 실패했습니다.")}catch{g.error("복원에 실패했습니다.")}}function I(a){y(a)}G([x,f,h,m],()=>{y(0)});function R(){m.value=m.value==="desc"?"asc":"desc"}function F(a){x.value=a}const H=Y(()=>{const{startDate:a,endDate:e}=M(x.value);return a===e?a:`${a} ~ ${e}`});return U(()=>{const a=v(new Date);f.value=a,h.value=a,y()}),(a,e)=>(l(),c("div",at,[t("div",ot,[t("div",null,[e[2]||(e[2]=t("h2",{class:"text-xl font-semibold text-gray-900 flex items-center gap-2"},[p(" 삭제된 작업 "),t("svg",{class:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})])],-1)),t("p",rt,n(H.value),1)]),t("div",nt,[t("span",null,"총 "+n(r.value.totalElements)+"건",1)])]),t("div",lt,[t("div",it,[t("div",ct,[e[3]||(e[3]=t("span",{class:"text-sm font-medium text-gray-700"},"기간:",-1)),t("div",dt,[(l(),c(D,null,$(j,s=>t("button",{key:s.value,class:N(["px-3 py-1.5 text-[13px] transition-colors",[x.value===s.value?"bg-primary-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"]]),onClick:o=>F(s.value)},n(s.label),11,ut)),64))])]),w(q,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 -translate-x-2","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-2"},{default:E(()=>[x.value==="custom"?(l(),c("div",pt,[z(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>f.value=s),type:"date",class:"px-3 py-1.5 text-[13px] border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[P,f.value]]),e[4]||(e[4]=t("span",{class:"text-gray-400"},"~",-1)),z(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>h.value=s),type:"date",class:"px-3 py-1.5 text-[13px] border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[P,h.value]])])):S("",!0)]),_:1}),t("div",xt,[e[6]||(e[6]=t("span",{class:"text-sm text-gray-600"},"삭제시간순",-1)),t("button",{class:"p-1.5 rounded hover:bg-gray-100 transition-colors",title:m.value==="desc"?"내림차순 (최신순)":"오름차순 (오래된순)",onClick:R},[(l(),c("svg",{class:N(["w-4 h-4 text-gray-600 transition-transform",{"rotate-180":m.value==="asc"}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[5]||(e[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,mt)])])]),t("div",gt,[k.value?(l(),c("div",ft,[w(_(Z),{size:"lg"})])):b.value.length===0?(l(),W(_(et),{key:1,title:"삭제된 작업이 없습니다",description:"해당 기간에 삭제된 작업이 없습니다.",icon:"trash",class:"flex-1"})):(l(),c(D,{key:2},[t("div",ht,[t("table",vt,[e[7]||(e[7]=t("thead",{class:"sticky top-0 bg-gray-50 z-10"},[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),p(" 등록시간 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})]),p(" 삭제시간 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap min-w-[250px]"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),p(" 삭제 내용 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),p(" 삭제 전 상태 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),p(" 작업자 ")])]),t("th",{class:"px-4 h-10 text-center text-[13px] font-medium text-gray-600 whitespace-nowrap"}," 처리 ")])],-1)),t("tbody",yt,[(l(!0),c(D,null,$(b.value,s=>{var o;return l(),c("tr",{key:s.itemId,class:"hover:bg-gray-50 transition-colors"},[t("td",wt,n(C(s.createdAt)),1),t("td",_t,n(C(s.deletedAt)),1),t("td",kt,[t("div",bt,[t("span",{class:"truncate max-w-[350px]",title:s.title},n(s.title),9,Dt),s.boardName?(l(),c("span",St,n(s.boardName),1)):S("",!0)])]),t("td",Mt,[w(_(tt),{variant:B(s.previousStatus),size:"sm"},{default:E(()=>[p(n(T(s.previousStatus)),1)]),_:2},1032,["variant"])]),t("td",Ct,[t("div",Tt,[t("div",$t,n(((o=s.workerName)==null?void 0:o.charAt(0))||"?"),1),t("span",null,n(s.workerName||"-"),1)])]),t("td",Et,[t("button",{class:"px-3 py-1.5 text-[12px] font-medium text-white bg-blue-500 hover:bg-blue-600 rounded transition-colors",onClick:i=>A(s)}," 복원 ",8,Nt)])])}),128))])])]),r.value.totalPages>1?(l(),c("div",zt,[t("div",Pt,n(r.value.page*r.value.size+1)+" - "+n(Math.min((r.value.page+1)*r.value.size,r.value.totalElements))+" / "+n(r.value.totalElements)+"건 ",1),w(_(st),{"current-page":r.value.page,"total-pages":r.value.totalPages,onChange:I},null,8,["current-page","total-pages"])])):S("",!0)],64))])]))}});export{Yt as default};
