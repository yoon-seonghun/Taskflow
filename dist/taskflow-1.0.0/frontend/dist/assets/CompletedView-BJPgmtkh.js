import{d as O,r as u,z as L,c as H,o as Y,f as c,g as t,t as n,k as w,F as b,s as $,m as U,T as q,q as z,x as R,j as k,i as D,p as v,l as j,L as E,n as l}from"./index-D8qsMxsh.js";import{h as W}from"./history-B3yM7zqs.js";import{u as G}from"./useToast-BaLNVjwd.js";import{u as J}from"./useSlideOver-DM1nQhnY.js";import"./MarkdownEditor.vue_vue_type_style_index_0_scoped_f90f4426_lang-Bc65I5vA.js";import{_ as K}from"./Spinner.vue_vue_type_script_setup_true_lang-i4Z96JvV.js";import{_ as Q}from"./EmptyState.vue_vue_type_script_setup_true_lang-DF03tBGG.js";import{_ as X}from"./Pagination.vue_vue_type_script_setup_true_lang-D8QDOFFt.js";const Z={class:"h-full flex flex-col"},tt={class:"flex items-center justify-between mb-4"},et={class:"text-sm text-gray-500 mt-1"},st={class:"flex items-center gap-2 text-sm text-gray-600"},at={class:"bg-white rounded-lg border border-gray-200 p-4 mb-4"},ot={class:"flex flex-wrap items-center gap-4"},rt={class:"flex items-center gap-2"},nt={class:"flex rounded-lg border border-gray-200 overflow-hidden"},lt=["onClick"],it={key:0,class:"flex items-center gap-2"},ct={class:"ml-auto flex items-center gap-2"},dt=["title"],ut={class:"flex-1 bg-white rounded-lg border border-gray-200 overflow-hidden flex flex-col"},pt={key:0,class:"flex-1 flex items-center justify-center"},xt={class:"flex-1 overflow-auto"},gt={class:"w-full"},mt={class:"divide-y divide-gray-100"},ft={class:"px-4 h-10 text-[13px] text-gray-600 whitespace-nowrap"},vt={class:"px-4 h-10 text-[13px] text-gray-600 whitespace-nowrap"},ht={class:"px-4 h-10 text-[13px] text-gray-900"},yt={class:"flex items-center gap-2"},_t=["title"],wt=["onClick"],bt={key:0,class:"px-1.5 py-0.5 text-[11px] bg-gray-100 text-gray-500 rounded"},kt={class:"px-4 h-10 text-[13px] text-gray-600 whitespace-nowrap"},Dt={class:"flex items-center gap-2"},Ct={class:"w-6 h-6 rounded-full bg-primary-100 text-primary-600 flex items-center justify-center text-[11px] font-medium"},Mt={key:0,class:"border-t border-gray-200 px-4 py-3 flex items-center justify-between"},St={class:"text-sm text-gray-500"},It=O({__name:"CompletedView",setup($t){const C=G(),{openItemDetail:V}=J();function B(a,e){V(a,e)}const h=u(!1),y=u([]),r=u({page:0,size:20,totalElements:0,totalPages:0}),p=u("today"),g=u(""),m=u(""),x=u("desc"),P=[{value:"today",label:"오늘"},{value:"week",label:"이번주"},{value:"month",label:"이번달"},{value:"custom",label:"사용자 지정"}];function M(a){const e=new Date,s=f(e);switch(a){case"today":return{startDate:s,endDate:s};case"week":{const o=new Date(e),i=e.getDay(),d=i===0?6:i-1;return o.setDate(e.getDate()-d),{startDate:f(o),endDate:s}}case"month":{const o=new Date(e.getFullYear(),e.getMonth(),1);return{startDate:f(o),endDate:s}}case"custom":return{startDate:g.value||s,endDate:m.value||s};default:return{startDate:s,endDate:s}}}function f(a){const e=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0");return`${e}-${s}-${o}`}function S(a){if(!a)return"-";const e=new Date(a),s=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),d=String(e.getHours()).padStart(2,"0"),A=String(e.getMinutes()).padStart(2,"0");return`${s}-${o}-${i} ${d}:${A}`}async function _(a=0){h.value=!0;try{const{startDate:e,endDate:s}=M(p.value),o={result:"COMPLETED",startDate:e,endDate:s,page:a,size:r.value.size,sort:`completedAt,${x.value}`},i=await W.getItemHistory(o);if(i.success&&i.data){const d=i.data;y.value=d.content,r.value={page:d.page,size:d.size,totalElements:d.totalElements,totalPages:d.totalPages}}else C.error(i.message||"완료된 작업을 불러오는데 실패했습니다.")}catch{C.error("완료된 작업을 불러오는데 실패했습니다.")}finally{h.value=!1}}function N(a){_(a)}L([p,g,m,x],()=>{_(0)});function T(){x.value=x.value==="desc"?"asc":"desc"}function I(a){p.value=a}const F=H(()=>{const{startDate:a,endDate:e}=M(p.value);return a===e?a:`${a} ~ ${e}`});return Y(()=>{const a=f(new Date);g.value=a,m.value=a,_()}),(a,e)=>(l(),c("div",Z,[t("div",tt,[t("div",null,[e[2]||(e[2]=t("h2",{class:"text-xl font-semibold text-gray-900"},"완료 작업",-1)),t("p",et,n(F.value),1)]),t("div",st,[t("span",null,"총 "+n(r.value.totalElements)+"건",1)])]),t("div",at,[t("div",ot,[t("div",rt,[e[3]||(e[3]=t("span",{class:"text-sm font-medium text-gray-700"},"기간:",-1)),t("div",nt,[(l(),c(b,null,$(P,s=>t("button",{key:s.value,class:z(["px-3 py-1.5 text-[13px] transition-colors",[p.value===s.value?"bg-primary-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"]]),onClick:o=>I(s.value)},n(s.label),11,lt)),64))])]),w(q,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 -translate-x-2","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-2"},{default:U(()=>[p.value==="custom"?(l(),c("div",it,[j(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),type:"date",class:"px-3 py-1.5 text-[13px] border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[E,g.value]]),e[4]||(e[4]=t("span",{class:"text-gray-400"},"~",-1)),j(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),type:"date",class:"px-3 py-1.5 text-[13px] border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[E,m.value]])])):D("",!0)]),_:1}),t("div",ct,[e[6]||(e[6]=t("span",{class:"text-sm text-gray-600"},"완료시간순",-1)),t("button",{class:"p-1.5 rounded hover:bg-gray-100 transition-colors",title:x.value==="desc"?"내림차순 (최신순)":"오름차순 (오래된순)",onClick:T},[(l(),c("svg",{class:z(["w-4 h-4 text-gray-600 transition-transform",{"rotate-180":x.value==="asc"}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[5]||(e[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,dt)])])]),t("div",ut,[h.value?(l(),c("div",pt,[w(k(K),{size:"lg"})])):y.value.length===0?(l(),R(k(Q),{key:1,title:"완료된 작업이 없습니다",description:"해당 기간에 완료된 작업이 없습니다.",icon:"check-circle",class:"flex-1"})):(l(),c(b,{key:2},[t("div",xt,[t("table",gt,[e[7]||(e[7]=t("thead",{class:"sticky top-0 bg-gray-50 z-10"},[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),v(" 등록시간 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),v(" 완료시간 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap min-w-[300px]"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),v(" 작업 내용 ")])]),t("th",{class:"px-4 h-10 text-left text-[13px] font-medium text-gray-600 whitespace-nowrap"},[t("div",{class:"flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),v(" 작업자 ")])])])],-1)),t("tbody",mt,[(l(!0),c(b,null,$(y.value,s=>{var o;return l(),c("tr",{key:s.itemId,class:"group hover:bg-gray-50 transition-colors"},[t("td",ft,n(S(s.createdAt)),1),t("td",vt,n(S(s.completedAt)),1),t("td",ht,[t("div",yt,[t("span",{class:"truncate max-w-[400px]",title:s.title},n(s.title),9,_t),t("button",{class:"flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity px-1.5 py-0.5 text-[11px] text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded",title:"상세 패널 열기",onClick:i=>B(s.itemId,s.boardId)}," 열기 ",8,wt),s.boardName?(l(),c("span",bt,n(s.boardName),1)):D("",!0)])]),t("td",kt,[t("div",Dt,[t("div",Ct,n(((o=s.workerName)==null?void 0:o.charAt(0))||"?"),1),t("span",null,n(s.workerName||"-"),1)])])])}),128))])])]),r.value.totalPages>1?(l(),c("div",Mt,[t("div",St,n(r.value.page*r.value.size+1)+" - "+n(Math.min((r.value.page+1)*r.value.size,r.value.totalElements))+" / "+n(r.value.totalElements)+"건 ",1),w(k(X),{"current-page":r.value.page,"total-pages":r.value.totalPages,onChange:N},null,8,["current-page","total-pages"])])):D("",!0)],64))])]))}});export{It as default};
