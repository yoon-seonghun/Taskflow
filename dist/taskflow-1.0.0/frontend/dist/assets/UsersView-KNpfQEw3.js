import{d as se,D as ie,r as c,c as $,z as ye,o as ue,f as o,g as e,k as F,i as w,p as x,l as K,U as ae,q as B,t as _,w as Z,L as re,F as Q,s as W,I as J,n as l,m as xe}from"./index-D8qsMxsh.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-DbFXPxNG.js";import{d as _e}from"./department-Dz_c4A8s.js";import{g as be}from"./group-CxfoGHwP.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Ce}from"./Badge.vue_vue_type_script_setup_true_lang-BICiYF9q.js";import{_ as Me}from"./Pagination.vue_vue_type_script_setup_true_lang-D8QDOFFt.js";import{_ as $e}from"./Select.vue_vue_type_script_setup_true_lang-CpAO5_7Q.js";import{u as H}from"./user-BWwGCR1b.js";const Ve={class:"user-form"},Le={class:"space-y-4"},je={key:0,class:"mt-1 text-xs text-gray-500"},Be={class:"flex items-center justify-between mb-1"},Ie={class:"block text-[13px] font-medium text-gray-700"},Ue={key:0,class:"text-red-500 ml-0.5"},Se={class:"relative"},Ne=["type","placeholder","disabled"],Ye={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},De={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ze={key:0,class:"mt-2 space-y-1"},Fe={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ae={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},Ee={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},Te={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ge={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},Pe={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},qe={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oe={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},Re={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},He={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ke={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},Ze={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},Je={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qe={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},We={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},Xe={key:0},et={class:"block text-[13px] font-medium text-gray-700 mb-1"},tt={key:0,class:"text-red-500 ml-0.5"},st={class:"relative"},ot=["type","disabled"],lt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},nt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},at={key:0,class:"mt-1 text-xs text-red-500"},rt={class:"form-field"},it={class:"relative"},ut={key:0,class:"text-gray-900"},dt={key:1,class:"text-gray-400"},ct={class:"flex items-center gap-1"},vt={key:0,class:"dropdown"},pt={class:"dropdown-search"},mt={class:"dropdown-list"},ft=["onMousedown"],gt={key:0,class:"tree-indent"},ht={key:1,class:"w-4 h-4 ml-auto text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},kt={class:"form-field"},wt={key:0,class:"tags-container"},yt=["onClick"],xt={class:"relative"},_t={key:0,class:"dropdown"},bt={class:"dropdown-search"},Ct={class:"dropdown-list"},Mt={key:0,class:"dropdown-empty"},$t=["onMousedown"],Vt={class:"group-name"},Lt={class:"group-code"},jt={class:"flex items-center gap-2 pt-2"},Bt=["disabled"],It={key:0,class:"flex items-center justify-center gap-2"},Ut={key:1},St=["disabled"],Nt=se({__name:"UserForm",props:{user:{default:null},loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(f,{expose:h,emit:P}){const V=f,L=P,I=ie(),b=c(""),C=c(""),m=c(""),r=c(""),a=c(null),i=c([]),U=c([]),N=c([]),M=c(!1),q=c(!1),A=c(!1),O=c(!1),Y=c(""),S=c(""),E=c(!1),T=c(!1),k=$(()=>!!V.user),X=$(()=>k.value?"변경":"등록"),d=$(()=>{const s=[],t=(n,D=0)=>{var R;for(const z of n)z.useYn==="Y"&&(s.push({id:z.departmentId,name:z.departmentName,depth:D}),(R=z.children)!=null&&R.length&&t(z.children,D+1))};return t(U.value),s}),u=$(()=>{if(!Y.value)return d.value;const s=Y.value.toLowerCase();return d.value.filter(t=>t.name.toLowerCase().includes(s))}),p=$(()=>{if(!a.value)return"";const s=d.value.find(t=>t.id===a.value);return(s==null?void 0:s.name)||""}),g=$(()=>N.value.filter(s=>i.value.includes(s.groupId))),y=$(()=>{let s=N.value.filter(t=>t.useYn==="Y"&&!i.value.includes(t.groupId));if(S.value){const t=S.value.toLowerCase();s=s.filter(n=>n.groupName.toLowerCase().includes(t)||n.groupCode.toLowerCase().includes(t))}return s}),v=$(()=>{const s=m.value,t=s.length>=8,n=/[A-Z]/.test(s),D=/[a-z]/.test(s),R=/[0-9]/.test(s),z=/[!@#$%^&*]/.test(s);return{minLength:t,hasUppercase:n,hasLowercase:D,hasNumber:R,hasSpecial:z,isValid:t&&n&&D&&R&&z}}),j=$(()=>!m.value||!r.value?!0:m.value===r.value),G=$(()=>{const s=C.value;if(!s)return{isValid:!0,message:""};const t=s.length>=4&&s.length<=20;return/^[a-zA-Z0-9]+$/.test(s)?t?{isValid:!0,message:""}:{isValid:!1,message:"4~20자로 입력해주세요."}:{isValid:!1,message:"영문과 숫자만 사용 가능합니다."}}),le=$(()=>b.value.trim()?k.value?!(m.value&&(!v.value.isValid||!j.value)):!(!C.value.trim()||!G.value.isValid||!m.value||!v.value.isValid||!j.value):!1);async function de(){M.value=!0;try{const s=await _e.getDepartments({useYn:"Y"});s.success&&s.data&&(U.value=s.data)}catch(s){console.error("Failed to load departments:",s),I.showError("부서 목록을 불러오는데 실패했습니다.")}finally{M.value=!1}}async function ce(){q.value=!0;try{const s=await be.getGroups({useYn:"Y"});s.success&&s.data&&(N.value=s.data)}catch(s){console.error("Failed to load groups:",s),I.showError("그룹 목록을 불러오는데 실패했습니다.")}finally{q.value=!1}}function ee(){b.value="",C.value="",m.value="",r.value="",a.value=null,i.value=[],E.value=!1,T.value=!1,Y.value="",S.value=""}function ve(s){var t;b.value=s.userName,C.value=s.username,a.value=s.departmentId??null,i.value=s.groupIds??((t=s.groups)==null?void 0:t.map(n=>n.groupId))??[],m.value="",r.value=""}function ne(s){a.value=s,A.value=!1,Y.value=""}function pe(){a.value=null}function me(s){i.value.includes(s)||i.value.push(s),S.value=""}function fe(s){i.value=i.value.filter(t=>t!==s)}function ge(){setTimeout(()=>{A.value=!1},200)}function he(){setTimeout(()=>{O.value=!1},200)}function ke(){if(!(!le.value||V.loading))if(k.value){const s={userName:b.value.trim(),departmentId:a.value??void 0,groupIds:i.value.length>0?i.value:void 0};m.value&&v.value.isValid&&j.value&&(s.password=m.value),L("submit",s)}else{const s={username:C.value.trim(),password:m.value,passwordConfirm:r.value,userName:b.value.trim(),departmentId:a.value??void 0,groupIds:i.value.length>0?i.value:void 0};L("submit",s)}}function we(){ee(),L("cancel")}return ye(()=>V.user,s=>{s?ve(s):ee()},{immediate:!0}),ue(()=>{de(),ce()}),h({resetForm:ee}),(s,t)=>(l(),o("div",Ve,[e("div",Le,[F(te,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=n=>b.value=n),label:"사용자 이름",placeholder:"이름을 입력하세요",required:!0,maxlength:50,disabled:f.loading},null,8,["modelValue","disabled"]),e("div",null,[F(te,{modelValue:C.value,"onUpdate:modelValue":t[1]||(t[1]=n=>C.value=n),label:"아이디",placeholder:"영문+숫자 4~20자",required:!k.value,maxlength:20,disabled:f.loading||k.value,error:!G.value.isValid&&C.value.length>0,"error-message":G.value.message},null,8,["modelValue","required","disabled","error","error-message"]),k.value?(l(),o("p",je," 아이디는 변경할 수 없습니다. ")):w("",!0)]),e("div",null,[e("div",Be,[e("label",Ie,[t[11]||(t[11]=x(" 비밀번호 ",-1)),k.value?w("",!0):(l(),o("span",Ue,"*"))])]),e("div",Se,[K(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>m.value=n),type:E.value?"text":"password",placeholder:k.value?"변경 시에만 입력":"비밀번호를 입력하세요",class:B(["input-field pr-10",{"border-red-500":m.value&&!v.value.isValid}]),disabled:f.loading},null,10,Ne),[[ae,m.value]]),e("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",onClick:t[3]||(t[3]=n=>E.value=!E.value)},[E.value?(l(),o("svg",Ye,[...t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(l(),o("svg",De,[...t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),m.value?(l(),o("div",ze,[e("div",{class:B(["flex items-center gap-2 text-xs",v.value.minLength?"text-green-600":"text-gray-500"])},[(l(),o("svg",Fe,[v.value.minLength?(l(),o("path",Ae)):(l(),o("path",Ee))])),t[14]||(t[14]=x(" 최소 8자 이상 ",-1))],2),e("div",{class:B(["flex items-center gap-2 text-xs",v.value.hasUppercase?"text-green-600":"text-gray-500"])},[(l(),o("svg",Te,[v.value.hasUppercase?(l(),o("path",Ge)):(l(),o("path",Pe))])),t[15]||(t[15]=x(" 영문 대문자 포함 ",-1))],2),e("div",{class:B(["flex items-center gap-2 text-xs",v.value.hasLowercase?"text-green-600":"text-gray-500"])},[(l(),o("svg",qe,[v.value.hasLowercase?(l(),o("path",Oe)):(l(),o("path",Re))])),t[16]||(t[16]=x(" 영문 소문자 포함 ",-1))],2),e("div",{class:B(["flex items-center gap-2 text-xs",v.value.hasNumber?"text-green-600":"text-gray-500"])},[(l(),o("svg",He,[v.value.hasNumber?(l(),o("path",Ke)):(l(),o("path",Ze))])),t[17]||(t[17]=x(" 숫자 포함 ",-1))],2),e("div",{class:B(["flex items-center gap-2 text-xs",v.value.hasSpecial?"text-green-600":"text-gray-500"])},[(l(),o("svg",Je,[v.value.hasSpecial?(l(),o("path",Qe)):(l(),o("path",We))])),t[18]||(t[18]=x(" 특수문자 포함 (!@#$%^&*) ",-1))],2)])):w("",!0)]),m.value||!k.value?(l(),o("div",Xe,[e("label",et,[t[19]||(t[19]=x(" 비밀번호 확인 ",-1)),k.value?w("",!0):(l(),o("span",tt,"*"))]),e("div",st,[K(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>r.value=n),type:T.value?"text":"password",placeholder:"비밀번호를 다시 입력하세요",class:B(["input-field pr-10",{"border-red-500":r.value&&!j.value}]),disabled:f.loading},null,10,ot),[[ae,r.value]]),e("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",onClick:t[5]||(t[5]=n=>T.value=!T.value)},[T.value?(l(),o("svg",lt,[...t[20]||(t[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(l(),o("svg",nt,[...t[21]||(t[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),r.value&&!j.value?(l(),o("p",at," 비밀번호가 일치하지 않습니다. ")):w("",!0)])):w("",!0),e("div",rt,[t[27]||(t[27]=e("label",{class:"block text-[13px] font-medium text-gray-700 mb-1"},"소속 부서",-1)),e("div",it,[e("div",{class:B(["select-trigger",{disabled:f.loading||M.value}]),onClick:t[6]||(t[6]=n=>!f.loading&&!M.value&&(A.value=!A.value))},[p.value?(l(),o("span",ut,_(p.value),1)):(l(),o("span",dt,"부서 선택")),e("div",ct,[a.value?(l(),o("button",{key:0,type:"button",class:"clear-btn",onClick:Z(pe,["stop"])},[...t[22]||(t[22]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):w("",!0),t[23]||(t[23]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])],2),A.value?(l(),o("div",vt,[e("div",pt,[t[24]||(t[24]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),K(e("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>Y.value=n),type:"text",class:"dropdown-search-input",placeholder:"부서 검색...",onBlur:ge},null,544),[[re,Y.value]])]),e("div",mt,[e("button",{type:"button",class:"dropdown-item",onMousedown:t[8]||(t[8]=Z(n=>ne(null),["prevent"]))},[...t[25]||(t[25]=[e("span",{class:"text-gray-400"},"(선택 안함)",-1)])],32),(l(!0),o(Q,null,W(u.value,n=>(l(),o("button",{key:n.id,type:"button",class:B(["dropdown-item",{selected:a.value===n.id}]),style:J({paddingLeft:`${n.depth*16+12}px`}),onMousedown:Z(D=>ne(n.id),["prevent"])},[n.depth>0?(l(),o("span",gt,"└")):w("",!0),x(" "+_(n.name)+" ",1),a.value===n.id?(l(),o("svg",ht,[...t[26]||(t[26]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):w("",!0)],46,ft))),128))])])):w("",!0)])]),e("div",kt,[t[31]||(t[31]=e("label",{class:"block text-[13px] font-medium text-gray-700 mb-1"},"소속 그룹",-1)),g.value.length>0?(l(),o("div",wt,[(l(!0),o(Q,null,W(g.value,n=>(l(),o("span",{key:n.groupId,class:"tag",style:J({backgroundColor:n.groupColor?`${n.groupColor}20`:"#E5E7EB",borderColor:n.groupColor||"#9CA3AF"})},[e("span",{class:"tag-dot",style:J({backgroundColor:n.groupColor||"#9CA3AF"})},null,4),x(" "+_(n.groupName)+" ",1),e("button",{type:"button",class:"tag-remove",onClick:D=>fe(n.groupId)},[...t[28]||(t[28]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,yt)],4))),128))])):w("",!0),e("div",xt,[e("div",{class:B(["select-trigger",{disabled:f.loading||q.value}]),onClick:t[9]||(t[9]=n=>!f.loading&&!q.value&&(O.value=!O.value))},[...t[29]||(t[29]=[e("span",{class:"text-gray-400"},"그룹 추가...",-1),e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],2),O.value?(l(),o("div",_t,[e("div",bt,[t[30]||(t[30]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),K(e("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>S.value=n),type:"text",class:"dropdown-search-input",placeholder:"그룹 검색...",onBlur:he},null,544),[[re,S.value]])]),e("div",Ct,[y.value.length===0?(l(),o("div",Mt,_(S.value?"검색 결과가 없습니다.":"추가할 그룹이 없습니다."),1)):w("",!0),(l(!0),o(Q,null,W(y.value,n=>(l(),o("button",{key:n.groupId,type:"button",class:"dropdown-item group-item",onMousedown:Z(D=>me(n.groupId),["prevent"])},[e("span",{class:"group-color",style:J({backgroundColor:n.groupColor||"#9CA3AF"})},null,4),e("span",Vt,_(n.groupName),1),e("span",Lt,_(n.groupCode),1)],40,$t))),128))])])):w("",!0)])]),e("div",jt,[e("button",{type:"button",class:"btn-primary flex-1",disabled:!le.value||f.loading,onClick:ke},[f.loading?(l(),o("span",It,[...t[32]||(t[32]=[e("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),x(" 처리중... ",-1)])])):(l(),o("span",Ut,_(X.value),1))],8,Bt),k.value?(l(),o("button",{key:0,type:"button",class:"btn-secondary",disabled:f.loading,onClick:we}," 취소 ",8,St)):w("",!0)])])]))}}),Yt=oe(Nt,[["__scopeId","data-v-821f278b"]]),Dt={class:"user-list-wrapper"},zt={key:0,class:"py-12 text-center"},Ft={key:1,class:"py-12 text-center"},At={key:2,class:"user-table"},Et=["onClick"],Tt={class:"font-medium text-gray-900"},Gt={class:"text-gray-600"},Pt={class:"text-gray-600"},qt={class:"text-gray-500"},Ot={class:"flex items-center gap-2"},Rt=["title","onClick"],Ht={key:0,class:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Kt={key:1,class:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Zt=["onClick"],Jt=se({__name:"UserList",props:{users:{},selectedUserId:{default:null},loading:{type:Boolean,default:!1}},emits:["select","toggle-status","delete"],setup(f,{emit:h}){const P=f,V=h,L=$(()=>P.users.length===0);function I(r){if(!r)return"-";const a=new Date(r);return isNaN(a.getTime())?"-":a.toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function b(r){V("select",r)}function C(r,a){r.stopPropagation(),V("toggle-status",a)}function m(r,a){r.stopPropagation(),V("delete",a)}return(r,a)=>(l(),o("div",Dt,[f.loading?(l(),o("div",zt,[...a[0]||(a[0]=[e("svg",{class:"animate-spin h-8 w-8 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),e("p",{class:"mt-2 text-sm text-gray-500"},"사용자 목록을 불러오는 중...",-1)])])):L.value?(l(),o("div",Ft,[...a[1]||(a[1]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),e("p",{class:"mt-2 text-sm text-gray-500"},"등록된 사용자가 없습니다.",-1)])])):(l(),o("table",At,[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",{class:"w-[120px]"},"사용자 이름"),e("th",{class:"w-[120px]"},"아이디"),e("th",{class:"w-[120px]"},"부서"),e("th",{class:"w-[80px]"},"상태"),e("th",{class:"w-[140px]"},"등록일시"),e("th",{class:"w-[100px]"},"관리")])],-1)),e("tbody",null,[(l(!0),o(Q,null,W(f.users,i=>(l(),o("tr",{key:i.userId,class:B(["cursor-pointer",{"bg-primary-50":f.selectedUserId===i.userId}]),onClick:U=>b(i)},[e("td",Tt,_(i.userName),1),e("td",Gt,_(i.username),1),e("td",Pt,_(i.departmentName||"-"),1),e("td",null,[F(Ce,{variant:i.useYn==="Y"?"success":"default",size:"sm"},{default:xe(()=>[x(_(i.useYn==="Y"?"활성":"비활성"),1)]),_:2},1032,["variant"])]),e("td",qt,_(I(i.createdAt)),1),e("td",null,[e("div",Ot,[e("button",{type:"button",class:"action-btn",title:i.useYn==="Y"?"비활성화":"활성화",onClick:U=>C(U,i)},[i.useYn==="Y"?(l(),o("svg",Ht,[...a[2]||(a[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"},null,-1)])])):(l(),o("svg",Kt,[...a[3]||(a[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])]))],8,Rt),e("button",{type:"button",class:"action-btn",title:"삭제",onClick:U=>m(U,i)},[...a[4]||(a[4]=[e("svg",{class:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Zt)])])],10,Et))),128))])]))]))}}),Qt=oe(Jt,[["__scopeId","data-v-ea09f63f"]]),Wt={class:"users-view"},Xt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},es={class:"lg:col-span-1"},ts={class:"sticky top-4"},ss={class:"text-base font-medium text-gray-900 mb-3"},os={class:"lg:col-span-2"},ls={class:"filter-section mb-4"},ns={class:"flex items-center gap-4"},as={class:"flex-1"},rs={class:"w-32"},is={class:"flex items-center justify-between mb-3"},us={class:"text-sm text-gray-600"},ds={class:"font-medium text-gray-900"},cs={class:"table-container"},vs={key:0,class:"mt-4 flex justify-center"},ps=se({__name:"UsersView",setup(f){const h=ie(),P=c([]),V=c(!1),L=c(!1),I=c(0),b=c(0),C=c(0),m=c(20),r=c(null),a=c(""),i=c(""),U=[{value:"",label:"전체"},{value:"Y",label:"활성"},{value:"N",label:"비활성"}],N=c(null);async function M(){V.value=!0;try{const d={page:I.value,size:m.value,keyword:a.value||void 0,useYn:i.value||void 0},u=await H.getUsers(d);P.value=u.data.content,b.value=u.data.totalPages,C.value=u.data.totalElements}catch(d){console.error("Failed to load users:",d),h.showError("사용자 목록을 불러오는데 실패했습니다.")}finally{V.value=!1}}async function q(d){var u,p,g;L.value=!0;try{await H.createUser(d),h.showSuccess("사용자가 등록되었습니다."),(u=N.value)==null||u.resetForm(),await M()}catch(y){console.error("Failed to create user:",y);const v=((g=(p=y.response)==null?void 0:p.data)==null?void 0:g.message)||"사용자 등록에 실패했습니다.";h.showError(v)}finally{L.value=!1}}async function A(d){var u,p,g;if(r.value){L.value=!0;try{await H.updateUser(r.value.userId,d),h.showSuccess("사용자 정보가 수정되었습니다."),r.value=null,(u=N.value)==null||u.resetForm(),await M()}catch(y){console.error("Failed to update user:",y);const v=((g=(p=y.response)==null?void 0:p.data)==null?void 0:g.message)||"사용자 수정에 실패했습니다.";h.showError(v)}finally{L.value=!1}}}function O(d){r.value?A(d):q(d)}function Y(){r.value=null}function S(d){r.value=d}async function E(d){var y,v;const u=d.useYn==="Y"?"N":"Y",p=u==="Y"?"활성화":"비활성화";if(await h.confirm({title:`사용자 ${p}`,message:`'${d.userName}' 사용자를 ${p}하시겠습니까?`,confirmText:p,cancelText:"취소"}))try{await H.updateUser(d.userId,{useYn:u}),h.showSuccess(`사용자가 ${p}되었습니다.`),await M()}catch(j){console.error("Failed to toggle user status:",j);const G=((v=(y=j.response)==null?void 0:y.data)==null?void 0:v.message)||`사용자 ${p}에 실패했습니다.`;h.showError(G)}}async function T(d){var p,g,y,v;if(await h.confirm({title:"사용자 삭제",message:`'${d.userName}' 사용자를 삭제하시겠습니까?
이 작업은 되돌릴 수 없습니다.`,confirmText:"삭제",cancelText:"취소",confirmType:"danger"}))try{await H.deleteUser(d.userId),h.showSuccess("사용자가 삭제되었습니다."),((p=r.value)==null?void 0:p.userId)===d.userId&&(r.value=null,(g=N.value)==null||g.resetForm()),await M()}catch(j){console.error("Failed to delete user:",j);const G=((v=(y=j.response)==null?void 0:y.data)==null?void 0:v.message)||"사용자 삭제에 실패했습니다.";h.showError(G)}}function k(){I.value=0,M()}function X(d){I.value=d,M()}return ue(()=>{M()}),(d,u)=>{var p;return l(),o("div",Wt,[u[5]||(u[5]=e("div",{class:"mb-6"},[e("h1",{class:"text-xl font-semibold text-gray-900"},"사용자 관리"),e("p",{class:"mt-1 text-sm text-gray-500"}," 사용자를 등록하고 관리합니다. ")],-1)),e("div",Xt,[e("div",es,[e("div",ts,[e("h2",ss,_(r.value?"사용자 수정":"사용자 등록"),1),F(Yt,{ref_key:"formRef",ref:N,user:r.value,loading:L.value,onSubmit:O,onCancel:Y},null,8,["user","loading"])])]),e("div",os,[e("div",ls,[e("div",ns,[e("div",as,[F(te,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=g=>a.value=g),placeholder:"이름 또는 아이디로 검색...",clearable:!0,onEnter:k},null,8,["modelValue"])]),e("div",rs,[F($e,{modelValue:i.value,"onUpdate:modelValue":u[1]||(u[1]=g=>i.value=g),options:U,placeholder:"상태",onChange:k},null,8,["modelValue"])]),e("button",{type:"button",class:"btn-primary h-8",onClick:k},[...u[2]||(u[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),x(" 검색 ",-1)])])])]),e("div",is,[e("p",us,[u[3]||(u[3]=x(" 총 ",-1)),e("span",ds,_(C.value),1),u[4]||(u[4]=x("명 ",-1))])]),e("div",cs,[F(Qt,{users:P.value,"selected-user-id":(p=r.value)==null?void 0:p.userId,loading:V.value,onSelect:S,onToggleStatus:E,onDelete:T},null,8,["users","selected-user-id","loading"])]),b.value>1?(l(),o("div",vs,[F(Me,{"current-page":I.value,"total-pages":b.value,onChange:X},null,8,["current-page","total-pages"])])):w("",!0)])])])}}}),bs=oe(ps,[["__scopeId","data-v-2870e808"]]);export{bs as default};
