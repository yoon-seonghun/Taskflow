import{G as ee,r as w,c as I,d as R,f,g as e,p as H,F as O,s as P,I as z,q as L,i as T,t as x,n as c,A as Z,z as Q,k as U,x as J,l as A,L as j,D as X,w as te,o as se,v as oe}from"./index-D8qsMxsh.js";import{g as N}from"./group-CxfoGHwP.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as K}from"./Input.vue_vue_type_script_setup_true_lang-DbFXPxNG.js";import{_ as ae}from"./Select.vue_vue_type_script_setup_true_lang-CpAO5_7Q.js";import{u as le}from"./user-BWwGCR1b.js";const W=ee("group",()=>{const v=w([]),p=w(null),u=w([]),i=w(!1),a=w(null),n=I(()=>v.value.filter(t=>t.useYn==="Y")),_=I(()=>{var t;return((t=p.value)==null?void 0:t.groupId)||null});async function g(t){i.value=!0,a.value=null;try{const s=await N.getGroups(t);return s.success&&s.data?(v.value=s.data,!0):(a.value=s.message||"그룹 목록을 불러오는데 실패했습니다.",!1)}catch{return a.value="그룹 목록을 불러오는데 실패했습니다.",!1}finally{i.value=!1}}async function y(t){i.value=!0,a.value=null;try{const s=await N.createGroup(t);return s.success&&s.data?(await g(),s.data):(a.value=s.message||"그룹 생성에 실패했습니다.",null)}catch{return a.value="그룹 생성에 실패했습니다.",null}finally{i.value=!1}}async function M(t,s){var C;a.value=null;try{const $=await N.updateGroup(t,s);if($.success&&$.data){const Y=v.value.findIndex(d=>d.groupId===t);return Y!==-1&&(v.value[Y]=$.data),((C=p.value)==null?void 0:C.groupId)===t&&(p.value=$.data),!0}return a.value=$.message||"그룹 수정에 실패했습니다.",!1}catch{return a.value="그룹 수정에 실패했습니다.",!1}}async function V(t){var s;a.value=null;try{const C=await N.deleteGroup(t);return C.success?(v.value=v.value.filter($=>$.groupId!==t),((s=p.value)==null?void 0:s.groupId)===t&&(p.value=null,u.value=[]),!0):(a.value=C.message||"그룹 삭제에 실패했습니다.",!1)}catch{return a.value="그룹 삭제에 실패했습니다.",!1}}async function D(t,s){try{return(await N.updateGroupOrder(t,s)).success?(await g(),!0):!1}catch{return!1}}async function G(t){try{const s=await N.getGroupMembers(t);return s.success&&s.data?(u.value=s.data,!0):!1}catch{return!1}}async function B(t,s){a.value=null;try{const C=await N.addGroupMember(t,{userId:s});return C.success?(await G(t),await g(),!0):(a.value=C.message||"멤버 추가에 실패했습니다.",!1)}catch{return a.value="멤버 추가에 실패했습니다.",!1}}async function E(t,s){a.value=null;try{const C=await N.removeGroupMember(t,s);return C.success?(u.value=u.value.filter($=>$.userId!==s),await g(),!0):(a.value=C.message||"멤버 제거에 실패했습니다.",!1)}catch{return a.value="멤버 제거에 실패했습니다.",!1}}function F(t){p.value=t,t?G(t.groupId):u.value=[]}function S(t){return v.value.find(s=>s.groupId===t)}function m(){p.value=null,u.value=[]}function o(){a.value=null}return{groups:v,selectedGroup:p,groupMembers:u,loading:i,error:a,activeGroups:n,selectedGroupId:_,fetchGroups:g,createGroup:y,updateGroup:M,deleteGroup:V,updateGroupOrder:D,fetchGroupMembers:G,addGroupMember:B,removeGroupMember:E,selectGroup:F,getGroupById:S,clearSelection:m,clearError:o}}),re={class:"group-list"},ne={key:0,class:"py-8 text-center"},ue={key:1,class:"py-8 text-center"},ie=["onClick","onDragstart","onDragover","onDrop"],ce={class:"card-content"},de={class:"card-header"},ve={class:"group-info"},pe={class:"group-code"},me={class:"card-actions"},fe=["onClick"],ge=["onClick"],he={key:0,class:"group-description"},ye={class:"card-footer"},ke={class:"member-count"},be=["title","onClick"],we={class:"toggle-label"},_e=R({__name:"GroupList",props:{showInactive:{type:Boolean,default:!0}},emits:["select","edit","delete","add","toggle-active"],setup(v,{emit:p}){const u=v,i=p,a=W(),n=w(null),_=w(null),g=I(()=>u.showInactive?a.groups:a.activeGroups),y=I(()=>a.loading),M=I(()=>g.value.length===0),V=I(()=>a.selectedGroupId);function D(d){a.selectGroup(d),i("select",d)}function G(d,r){d.stopPropagation(),i("edit",r)}function B(d,r){d.stopPropagation(),i("delete",r)}function E(d,r){d.stopPropagation(),i("toggle-active",r)}function F(){i("add")}function S(d,r){n.value=r,d.dataTransfer&&(d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("groupId",r.groupId.toString()))}function m(d,r){d.preventDefault(),n.value&&n.value.groupId!==r.groupId&&(_.value=r.groupId)}function o(){_.value=null}async function t(d,r){d.preventDefault(),n.value&&n.value.groupId!==r.groupId&&(await a.updateGroupOrder(n.value.groupId,r.sortOrder),C())}function s(){C()}function C(){n.value=null,_.value=null}function $(d){return d?{borderLeftColor:d,backgroundColor:`${d}08`}:{}}function Y(d){return d===void 0||d===0?"멤버 없음":`${d}명`}return(d,r)=>(c(),f("div",re,[e("div",{class:"list-header"},[r[1]||(r[1]=e("h3",{class:"list-title"},"그룹 목록",-1)),e("button",{type:"button",class:"add-btn",onClick:F},[...r[0]||(r[0]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),H(" 그룹 추가 ",-1)])])]),y.value?(c(),f("div",ne,[...r[2]||(r[2]=[e("svg",{class:"animate-spin h-8 w-8 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),e("p",{class:"mt-2 text-sm text-gray-500"},"그룹 목록을 불러오는 중...",-1)])])):M.value?(c(),f("div",ue,[r[3]||(r[3]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),r[4]||(r[4]=e("p",{class:"mt-2 text-sm text-gray-500"},"등록된 그룹이 없습니다.",-1)),e("button",{type:"button",class:"mt-3 text-sm text-primary-600 hover:text-primary-700",onClick:F}," + 첫 번째 그룹 추가하기 ")])):(c(),f("div",{key:2,class:"cards-container",onDragend:s},[(c(!0),f(O,null,P(g.value,k=>(c(),f("div",{key:k.groupId,class:L(["group-card",{selected:V.value===k.groupId,inactive:k.useYn!=="Y","drag-over":_.value===k.groupId}]),style:z($(k.groupColor)),draggable:"true",onClick:l=>D(k),onDragstart:l=>S(l,k),onDragover:l=>m(l,k),onDragleave:o,onDrop:l=>t(l,k)},[e("div",{class:"color-bar",style:z({backgroundColor:k.groupColor||"#9CA3AF"})},null,4),e("div",ce,[e("div",de,[e("div",ve,[e("h4",{class:L(["group-name",{inactive:k.useYn!=="Y"}])},x(k.groupName),3),e("span",pe,x(k.groupCode),1)]),e("div",me,[e("button",{type:"button",class:"action-btn",title:"수정",onClick:l=>G(l,k)},[...r[5]||(r[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,fe),e("button",{type:"button",class:"action-btn danger",title:"삭제",onClick:l=>B(l,k)},[...r[6]||(r[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ge)])]),k.groupDescription?(c(),f("p",he,x(k.groupDescription),1)):T("",!0),e("div",ye,[e("div",ke,[r[7]||(r[7]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),H(" "+x(Y(k.memberCount)),1)]),e("button",{type:"button",class:L(["toggle-btn",{active:k.useYn==="Y"}]),title:k.useYn==="Y"?"비활성화":"활성화",onClick:l=>E(l,k)},[r[8]||(r[8]=e("span",{class:"toggle-track"},[e("span",{class:"toggle-thumb"})],-1)),e("span",we,x(k.useYn==="Y"?"활성":"비활성"),1)],10,be)])])],46,ie))),128))],32))]))}}),Ce=q(_e,[["__scopeId","data-v-84963a1e"]]),xe={class:"group-form"},$e={class:"form-title"},Me={class:"space-y-4"},Ge={class:"form-field"},Ie=["disabled"],De={class:"form-field"},Ve={class:"color-field"},Be=["disabled"],Se={class:"color-value"},Fe={key:0,class:"color-picker"},Ee={class:"preset-colors"},Ye=["onClick"],Ne={class:"custom-color"},Te={class:"flex items-center gap-2 pt-2"},Ae=["disabled"],ze={key:0,class:"flex items-center justify-center gap-2"},Le={key:1},Ue=["disabled"],je=R({__name:"GroupForm",props:{group:{default:null},loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(v,{expose:p,emit:u}){const i=v,a=u,n=w(""),_=w(""),g=w(""),y=w("#3B82F6"),M=w(0),V=w("Y"),D=w(!1),G=["#EF4444","#F97316","#F59E0B","#EAB308","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#D946EF","#EC4899","#F43F5E","#6B7280"],B=I(()=>!!i.group),E=I(()=>B.value?"수정":"등록"),F=I(()=>B.value?"그룹 수정":"그룹 등록"),S=[{value:"Y",label:"활성"},{value:"N",label:"비활성"}],m=I(()=>n.value.trim().length>0&&_.value.trim().length>0),o=I(()=>{const l=n.value;if(!l)return{isValid:!0,message:""};const h=l.length>=2&&l.length<=20;return/^[a-zA-Z0-9_]+$/.test(l)?h?{isValid:!0,message:""}:{isValid:!1,message:"2~20자로 입력해주세요."}:{isValid:!1,message:"영문, 숫자, 언더스코어만 사용 가능합니다."}});function t(){n.value="",_.value="",g.value="",y.value="#3B82F6",M.value=0,V.value="Y",D.value=!1}function s(l){n.value=l.groupCode,_.value=l.groupName,g.value=l.groupDescription||"",y.value=l.groupColor||"#3B82F6",M.value=l.sortOrder,V.value=l.useYn}function C(l){y.value=l,Y()}let $=null;function Y(){D.value=!1,$&&(document.removeEventListener("click",$),$=null)}function d(l){l.stopPropagation(),D.value?Y():(D.value=!0,$=h=>{const b=h.target;!b.closest(".color-picker")&&!b.closest(".color-preview")&&Y()},setTimeout(()=>{$&&document.addEventListener("click",$)},0))}Z(()=>{Y()});function r(){if(!(!m.value||!o.value.isValid||i.loading))if(B.value){const l={groupCode:n.value.trim(),groupName:_.value.trim(),groupDescription:g.value.trim()||void 0,groupColor:y.value,sortOrder:M.value,useYn:V.value};a("submit",l)}else{const l={groupCode:n.value.trim(),groupName:_.value.trim(),groupDescription:g.value.trim()||void 0,groupColor:y.value,sortOrder:M.value};a("submit",l)}}function k(){t(),a("cancel")}return Q(()=>i.group,l=>{l?s(l):t()},{immediate:!0}),p({resetForm:t}),(l,h)=>(c(),f("div",xe,[e("h3",$e,x(F.value),1),e("div",Me,[U(K,{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=b=>n.value=b),label:"그룹 코드",placeholder:"영문, 숫자, 언더스코어 (예: PROJECT_A)",required:!0,maxlength:20,disabled:v.loading,error:!o.value.isValid&&n.value.length>0,"error-message":o.value.message},null,8,["modelValue","disabled","error","error-message"]),U(K,{modelValue:_.value,"onUpdate:modelValue":h[1]||(h[1]=b=>_.value=b),label:"그룹명",placeholder:"그룹명을 입력하세요",required:!0,maxlength:100,disabled:v.loading},null,8,["modelValue","disabled"]),e("div",Ge,[h[8]||(h[8]=e("label",{class:"field-label"},"그룹 설명",-1)),A(e("textarea",{"onUpdate:modelValue":h[2]||(h[2]=b=>g.value=b),class:"textarea",placeholder:"그룹에 대한 설명을 입력하세요",rows:"3",maxlength:500,disabled:v.loading},null,8,Ie),[[j,g.value]])]),e("div",De,[h[9]||(h[9]=e("label",{class:"field-label"},"그룹 색상",-1)),e("div",Ve,[e("button",{type:"button",class:"color-preview",style:z({backgroundColor:y.value}),disabled:v.loading,onClick:h[3]||(h[3]=b=>d(b))},[e("span",Se,x(y.value),1)],12,Be),D.value?(c(),f("div",Fe,[e("div",Ee,[(c(),f(O,null,P(G,b=>e("button",{key:b,type:"button",class:L(["color-swatch",{selected:y.value===b}]),style:z({backgroundColor:b}),onClick:It=>C(b)},null,14,Ye)),64))]),e("div",Ne,[A(e("input",{"onUpdate:modelValue":h[4]||(h[4]=b=>y.value=b),type:"color",class:"color-input"},null,512),[[j,y.value]]),A(e("input",{"onUpdate:modelValue":h[5]||(h[5]=b=>y.value=b),type:"text",class:"color-text",placeholder:"#3B82F6",maxlength:"7"},null,512),[[j,y.value]])])])):T("",!0)])]),U(K,{modelValue:M.value,"onUpdate:modelValue":h[6]||(h[6]=b=>M.value=b),modelModifiers:{number:!0},type:"number",label:"정렬 순서",placeholder:"0",disabled:v.loading},null,8,["modelValue","disabled"]),B.value?(c(),J(ae,{key:0,modelValue:V.value,"onUpdate:modelValue":h[7]||(h[7]=b=>V.value=b),options:S,label:"사용 여부",disabled:v.loading},null,8,["modelValue","disabled"])):T("",!0),e("div",Te,[e("button",{type:"button",class:"btn-primary flex-1",disabled:!m.value||!o.value.isValid||v.loading,onClick:r},[v.loading?(c(),f("span",ze,[...h[10]||(h[10]=[e("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),H(" 처리중... ",-1)])])):(c(),f("span",Le,x(E.value),1))],8,Ae),e("button",{type:"button",class:"btn-secondary",disabled:v.loading,onClick:k}," 취소 ",8,Ue)])])]))}}),He=q(je,[["__scopeId","data-v-d272dcdd"]]),Oe={class:"member-manager"},Pe={class:"manager-header"},Re={class:"header-info"},qe={class:"group-name"},Ke={class:"group-code"},Je={class:"member-count"},We={class:"search-section"},Ze={class:"search-field"},Qe={key:0,class:"animate-spin search-loading",fill:"none",viewBox:"0 0 24 24"},Xe={key:0,class:"search-dropdown"},et=["disabled","onMousedown"],tt={class:"user-avatar"},st={class:"user-info"},ot={class:"user-name"},at={class:"user-id"},lt={key:0,class:"user-dept"},rt={key:1,class:"animate-spin w-4 h-4 text-primary-600",fill:"none",viewBox:"0 0 24 24"},nt={key:2,class:"w-4 h-4 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ut={key:1,class:"search-empty"},it={class:"members-section"},ct={key:0,class:"empty-members"},dt={key:1,class:"members-list"},vt={class:"member-avatar"},pt={class:"member-info"},mt={class:"member-name"},ft={key:0,class:"member-dept"},gt={class:"joined-date"},ht=["onClick"],yt=R({__name:"GroupMemberManager",props:{group:{}},setup(v){const p=v,u=W(),i=X(),a=w(""),n=w([]),_=w(!1),g=w(!1),y=w(null),M=I(()=>u.groupMembers),V=I(()=>new Set(M.value.map(o=>o.userId))),D=I(()=>n.value.filter(o=>!V.value.has(o.userId)));let G=null;Z(()=>{G&&(clearTimeout(G),G=null)});async function B(){if(a.value.length<2){n.value=[],g.value=!1;return}_.value=!0;try{const o=await le.getUsers({keyword:a.value,useYn:"Y",size:10});o.success&&o.data&&(n.value=o.data.content||[],g.value=!0)}catch(o){console.error("Failed to search users:",o)}finally{_.value=!1}}Q(a,()=>{G&&clearTimeout(G),G=setTimeout(()=>{B()},300)});async function E(o){y.value=o.userId;try{await u.addGroupMember(p.group.groupId,o.userId)?(i.showSuccess(`${o.userName}님이 그룹에 추가되었습니다.`),a.value="",n.value=[],g.value=!1):i.showError(u.error||"멤버 추가에 실패했습니다.")}catch(t){console.error("Failed to add member:",t),i.showError("멤버 추가에 실패했습니다.")}finally{y.value=null}}async function F(o){if(await i.confirm({title:"멤버 제거",message:`'${o.userName}'님을 그룹에서 제거하시겠습니까?`,confirmText:"제거",cancelText:"취소",confirmType:"danger"}))try{await u.removeGroupMember(p.group.groupId,o.userId)?i.showSuccess(`${o.userName}님이 그룹에서 제거되었습니다.`):i.showError(u.error||"멤버 제거에 실패했습니다.")}catch(s){console.error("Failed to remove member:",s),i.showError("멤버 제거에 실패했습니다.")}}function S(){setTimeout(()=>{g.value=!1},200)}function m(o){return new Date(o).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}return(o,t)=>(c(),f("div",Oe,[e("div",Pe,[e("div",Re,[e("div",{class:"group-badge",style:z({backgroundColor:v.group.groupColor||"#3B82F6"})},x(v.group.groupName.charAt(0)),5),e("div",null,[e("h3",qe,x(v.group.groupName),1),e("p",Ke,x(v.group.groupCode),1)])]),e("span",Je,x(M.value.length)+"명",1)]),e("div",We,[e("div",Ze,[t[3]||(t[3]=e("svg",{class:"search-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),A(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value=s),type:"text",class:"search-input",placeholder:"사용자 이름 또는 아이디로 검색...",onFocus:t[1]||(t[1]=s=>g.value=n.value.length>0),onBlur:S},null,544),[[j,a.value]]),_.value?(c(),f("svg",Qe,[...t[2]||(t[2]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):T("",!0)]),g.value&&D.value.length>0?(c(),f("div",Xe,[(c(!0),f(O,null,P(D.value,s=>(c(),f("button",{key:s.userId,type:"button",class:"search-result-item",disabled:y.value===s.userId,onMousedown:te(C=>E(s),["prevent"])},[e("div",tt,x(s.userName.charAt(0)),1),e("div",st,[e("span",ot,x(s.userName),1),e("span",at,x(s.username),1)]),s.departmentName?(c(),f("span",lt,x(s.departmentName),1)):T("",!0),y.value===s.userId?(c(),f("svg",rt,[...t[4]||(t[4]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(c(),f("svg",nt,[...t[5]||(t[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"},null,-1)])]))],40,et))),128))])):g.value&&a.value.length>=2&&!_.value?(c(),f("div",ut,[...t[6]||(t[6]=[e("p",null,"검색 결과가 없습니다.",-1)])])):T("",!0)]),e("div",it,[t[9]||(t[9]=e("h4",{class:"section-title"},"그룹 멤버",-1)),M.value.length===0?(c(),f("div",ct,[...t[7]||(t[7]=[e("svg",{class:"w-10 h-10 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"mt-2"},"그룹에 멤버가 없습니다.",-1),e("p",{class:"text-xs"},"위 검색창에서 사용자를 검색하여 추가하세요.",-1)])])):(c(),f("div",dt,[(c(!0),f(O,null,P(M.value,s=>(c(),f("div",{key:s.userId,class:"member-item"},[e("div",vt,x(s.userName.charAt(0)),1),e("div",pt,[e("span",mt,x(s.userName),1),s.departmentName?(c(),f("span",ft,x(s.departmentName),1)):T("",!0)]),e("span",gt,x(m(s.joinedAt))+" 추가",1),e("button",{type:"button",class:"remove-btn",title:"멤버 제거",onClick:C=>F(s)},[...t[8]||(t[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ht)]))),128))]))])]))}}),kt=q(yt,[["__scopeId","data-v-c6bc5994"]]),bt={class:"groups-view"},wt={class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},_t={class:"lg:col-span-5"},Ct={class:"flex items-center justify-between mb-3"},xt={class:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer"},$t={class:"lg:col-span-7"},Mt={key:2,class:"empty-state"},Gt=R({__name:"GroupsView",setup(v){const p=W(),u=X(),i=w("none"),a=w(!1),n=w(null),_=w(!0),g=I(()=>p.selectedGroup),y=w(null);async function M(){await p.fetchGroups()}function V(m){i.value!=="none"&&(i.value="none",n.value=null)}function D(m){i.value="edit",n.value=m,p.clearSelection()}function G(){i.value="create",n.value=null,p.clearSelection()}async function B(m){const o=m.useYn==="Y"?"N":"Y",t=o==="Y"?"활성화":"비활성화";try{await p.updateGroup(m.groupId,{...m,groupDescription:m.groupDescription||void 0,useYn:o})?u.showSuccess(`그룹이 ${t}되었습니다.`):u.showError(p.error||`그룹 ${t}에 실패했습니다.`)}catch(s){console.error("Failed to toggle group status:",s),u.showError(`그룹 ${t}에 실패했습니다.`)}}async function E(m){if(m.memberCount&&m.memberCount>0){u.showWarning("멤버가 있는 그룹은 삭제할 수 없습니다. 먼저 멤버를 제거해주세요.");return}if(await u.confirm({title:"그룹 삭제",message:`'${m.groupName}' 그룹을 삭제하시겠습니까?`,confirmText:"삭제",cancelText:"취소",confirmType:"danger"}))try{await p.deleteGroup(m.groupId)?u.showSuccess("그룹이 삭제되었습니다."):u.showError(p.error||"그룹 삭제에 실패했습니다.")}catch(t){console.error("Failed to delete group:",t),u.showError("그룹 삭제에 실패했습니다.")}}async function F(m){a.value=!0;try{i.value==="edit"&&n.value?await p.updateGroup(n.value.groupId,m)?(u.showSuccess("그룹이 수정되었습니다."),S()):u.showError(p.error||"그룹 수정에 실패했습니다."):await p.createGroup(m)?(u.showSuccess("그룹이 등록되었습니다."),S()):u.showError(p.error||"그룹 등록에 실패했습니다.")}catch(o){console.error("Failed to save group:",o),u.showError("그룹 저장에 실패했습니다.")}finally{a.value=!1}}function S(){var m;i.value="none",n.value=null,(m=y.value)==null||m.resetForm()}return se(()=>{M()}),(m,o)=>(c(),f("div",bt,[o[3]||(o[3]=e("div",{class:"mb-6"},[e("h1",{class:"text-xl font-semibold text-gray-900"},"그룹 관리"),e("p",{class:"mt-1 text-sm text-gray-500"}," 업무 그룹을 등록하고 멤버를 관리합니다. ")],-1)),e("div",wt,[e("div",_t,[e("div",Ct,[e("label",xt,[A(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>_.value=t),type:"checkbox",class:"w-4 h-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[oe,_.value]]),o[1]||(o[1]=H(" 비활성 그룹 표시 ",-1))])]),U(Ce,{"show-inactive":_.value,onSelect:V,onEdit:D,onDelete:E,onAdd:G,onToggleActive:B},null,8,["show-inactive"])]),e("div",$t,[i.value!=="none"?(c(),J(He,{key:0,ref_key:"formRef",ref:y,group:n.value,loading:a.value,onSubmit:F,onCancel:S},null,8,["group","loading"])):g.value?(c(),J(kt,{key:1,group:g.value},null,8,["group"])):(c(),f("div",Mt,[...o[2]||(o[2]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"mt-2 text-sm text-gray-500"},"그룹을 선택하면 멤버를 관리할 수 있습니다.",-1)])]))])])]))}}),Yt=q(Gt,[["__scopeId","data-v-5dfb5ca0"]]);export{Yt as default};
