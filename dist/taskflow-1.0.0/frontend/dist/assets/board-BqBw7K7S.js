import{Q as g,O as p,P as h,S as z,G as F,r as i,c as f}from"./index-D8qsMxsh.js";const c={getBoards(r){return h("/boards",r)},getBoard(r){return h(`/boards/${r}`)},createBoard(r){return p("/boards",r)},updateBoard(r,n){return z(`/boards/${r}`,n)},deleteBoard(r){return g(`/boards/${r}`)},getBoardShares(r){return h(`/boards/${r}/shares`)},addBoardShare(r,n){return p(`/boards/${r}/shares`,n)},removeBoardShare(r,n){return g(`/boards/${r}/shares/${n}`)}},J=F("board",()=>{const r=i([]),n=i(null),l=i([]),d=i(!1),u=i(null),B=i("table"),y=f(()=>r.value.filter(e=>e.useYn==="Y")),w=f(()=>r.value.filter(e=>e.ownerYn==="Y")),S=f(()=>r.value.filter(e=>e.ownerYn!=="Y")),m=f(()=>{var e;return((e=n.value)==null?void 0:e.boardId)||null});function b(e){r.value=e}function _(e){r.value.push(e)}function v(e,a){var s;const t=r.value.findIndex(o=>o.boardId===e);t!==-1&&(r.value[t]={...r.value[t],...a}),((s=n.value)==null?void 0:s.boardId)===e&&(n.value={...n.value,...a})}function $(e){var a;r.value=r.value.filter(t=>t.boardId!==e),((a=n.value)==null?void 0:a.boardId)===e&&(n.value=null)}function Y(e){l.value.push(e)}function T(e){l.value=l.value.filter(a=>a.userId!==e)}async function k(e){d.value=!0,u.value=null;try{const a=await c.getBoards(e);return a.success&&a.data?(b(a.data),!0):(u.value=a.message||"보드 목록을 불러오는데 실패했습니다.",!1)}catch{return u.value="보드 목록을 불러오는데 실패했습니다.",!1}finally{d.value=!1}}async function x(e){d.value=!0,u.value=null;try{const a=await c.getBoard(e);return a.success&&a.data?(n.value=a.data,v(e,a.data),a.data):(u.value=a.message||"보드를 불러오는데 실패했습니다.",null)}catch{return u.value="보드를 불러오는데 실패했습니다.",null}finally{d.value=!1}}async function I(e){d.value=!0,u.value=null;try{const a=await c.createBoard(e);return a.success&&a.data?(_(a.data),a.data):(u.value=a.message||"보드 생성에 실패했습니다.",null)}catch{return u.value="보드 생성에 실패했습니다.",null}finally{d.value=!1}}async function C(e,a){const t=r.value.find(o=>o.boardId===e);if(!t)return!1;const s={...t};v(e,a);try{const o=await c.updateBoard(e,a);return o.success&&o.data?(v(e,o.data),!0):(v(e,s),u.value=o.message||"보드 수정에 실패했습니다.",!1)}catch{return v(e,s),u.value="보드 수정에 실패했습니다.",!1}}async function V(e){const a=[...r.value],t=n.value;$(e);try{const s=await c.deleteBoard(e);return s.success?!0:(r.value=a,n.value=t,u.value=s.message||"보드 삭제에 실패했습니다.",!1)}catch{return r.value=a,n.value=t,u.value="보드 삭제에 실패했습니다.",!1}}async function A(e){try{const a=await c.getBoardShares(e);return a.success&&a.data?(l.value=a.data,!0):!1}catch{return!1}}async function D(e,a){try{const t=await c.addBoardShare(e,a);return t.success&&t.data?(Y(t.data),t.data):(u.value=t.message||"공유 사용자 추가에 실패했습니다.",null)}catch{return u.value="공유 사용자 추가에 실패했습니다.",null}}async function E(e,a){const t=[...l.value];T(a);try{const s=await c.removeBoardShare(e,a);return s.success?!0:(l.value=t,u.value=s.message||"공유 사용자 제거에 실패했습니다.",!1)}catch{return l.value=t,u.value="공유 사용자 제거에 실패했습니다.",!1}}function G(e){n.value=e}function O(e){B.value=e,localStorage.setItem("taskflow_viewType",e)}function P(){const e=localStorage.getItem("taskflow_viewType");e&&["table","kanban","list"].includes(e)&&(B.value=e)}function Q(e){return r.value.find(a=>a.boardId===e)}function j(){r.value=[],n.value=null,l.value=[],u.value=null}function q(){u.value=null}return{boards:r,currentBoard:n,boardShares:l,loading:d,error:u,viewType:B,activeBoards:y,ownedBoards:w,sharedBoards:S,currentBoardId:m,fetchBoards:k,fetchBoard:x,createBoard:I,updateBoard:C,deleteBoard:V,fetchBoardShares:A,addBoardShare:D,removeBoardShare:E,setCurrentBoard:G,setViewType:O,loadViewType:P,getBoardById:Q,clearBoards:j,clearError:q}});export{J as u};
